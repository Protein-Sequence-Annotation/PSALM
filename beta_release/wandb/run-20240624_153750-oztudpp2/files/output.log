
Shards completed:   0%|          | 0/4 [00:00<?, ?it/s]/n/eddy_lab/Lab/protein_annotation_dl/envs/protllm/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:140: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Shards completed:   0%|          | 0/4 [01:04<?, ?it/s]
Traceback (most recent call last):
  File "/net/holy-nfsisilon/ifs/rc_labs/eddy_lab/Lab/protein_annotation_dl/PSALM/beta_release/psalm_train.py", line 115, in <module>
    shard_loss, n_batches = train_fn(data_loader = data_loader,
  File "/net/holy-nfsisilon/ifs/rc_labs/eddy_lab/Lab/protein_annotation_dl/PSALM/beta_release/ml_utils.py", line 334, in train_step_clan_batch
    target_vectors = np.zeros((len(sequence_labels), embedding.shape[1]))
AttributeError: 'dict' object has no attribute 'shape'
Traceback (most recent call last):
  File "/net/holy-nfsisilon/ifs/rc_labs/eddy_lab/Lab/protein_annotation_dl/PSALM/beta_release/psalm_train.py", line 115, in <module>
    shard_loss, n_batches = train_fn(data_loader = data_loader,
  File "/net/holy-nfsisilon/ifs/rc_labs/eddy_lab/Lab/protein_annotation_dl/PSALM/beta_release/ml_utils.py", line 334, in train_step_clan_batch
    target_vectors = np.zeros((len(sequence_labels), embedding.shape[1]))
AttributeError: 'dict' object has no attribute 'shape'